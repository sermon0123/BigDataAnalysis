import pandas as pd
import os
from homework_6 import utils as utils
from math import pow, sqrt

from copy import deepcopy
# 边界值,低于该值则使用基于内容的推荐算法
boundry_value=0.2

# 修正数据,使得用户对未评价电影的评分为默认分0
def correctData(fileData):
    data=deepcopy(fileData) #深度拷贝
    avg_movie = utils.get_avg("./ratings.csv")
    for key in data.keys():
        for movieid in data[key].keys():
            data[key][movieid] -= avg_movie[movieid]
    return data


# 计算两个用户的cos相似度 
def cos_(user1,user2,data):
    user1_data = data[user1]
    user2_data = data[user2]
    # print("user1_data: ",user1_data)
    # print("user2_data: ",user2_data)
    Molecular=0
    for key in user1_data.keys():
        if key in user2_data.keys():
            Molecular+=float(user1_data[key])*float(user2_data[key])
    rxdistance=0
    for key in user1_data.keys():
        rxdistance+=user1_data[key]*user1_data[key]
    rxdistance=sqrt(rxdistance)
    rydistance = 0
    for key in user2_data.keys():
        rydistance += user2_data[key] * user2_data[key]
    rydistance = sqrt(rydistance)

    cos=Molecular/(rxdistance*rydistance)
    return cos

# 找到与用户最相似的用户
def most_similar(userID,data):
    res = []
    for userid in data.keys():
        if not userid == userID:
            sim = cos_(userID, userid,data)
            res.append((userid, sim))
    res.sort(key=lambda val: val[1], reverse=True)

    return res[0]

# 获得每个用户最相似的用户列表
def get_similar_list(data):
    record={}
    for key in data.keys():
        res=most_similar(key,data)
        record[key]=res
    return record


# 获得与用户最相似的用户的高分电影，推荐给用户
def recommend(fileData,user,most_sim,sim, k=3):
    recomm = []
    # 最高相似度小于0.2时，认为没有与用户相似的用户，返回-1
    if sim< 0.2:
        return -1

    items = fileData[most_sim]

    for item in items.keys():
        if item not in fileData[user].keys() and items[item]>4.0:
            recomm.append((item, items[item]))

    # 当相似的用户没有看过与该用户不同且评分在4分以上的电影时，返回-1
    if(len(recomm)==0):
        return -1
    recomm.sort(key=lambda val: val[1], reverse=True)

    # 推荐电影数小于3时直接推荐，大于3时只推荐前3部
    if(len(recomm)<3):
        return {user:recomm}
    else:
        return {user:recomm[:k]}



def run_main():
    movies = pd.read_csv('./movies.csv')
    ratings = pd.read_csv('./ratings.csv')
    movies_list = movies['movieId']

    fileData = pd.merge(movies, ratings, on='movieId')  # 通过两数据框之间的movieId连接
    fileData[['userId', 'rating', 'movieId', 'title']].sort_values('userId').to_csv('./merged.csv', index=False)
    fileData=utils.get_data()
    data=correctData(fileData)

    similar_list=get_similar_list(data)
    # print(similar_list)
    # similar_list={'1': ('452', 0.14408506841435184), '2': ('189', 0.17428407071458774), '3': ('496', 0.1790076798135405), '4': ('75', 0.11587585716746907), '5': ('145', 0.34103057962210376), '6': ('584', 0.2714895176759674), '7': ('296', 0.19208896054250865), '8': ('565', 0.2514320502399256), '9': ('441', 0.1459106041484581), '10': ('16', 0.16063444445911162), '11': ('379', 0.20157678736275167), '12': ('280', 0.14437738304254058), '13': ('299', 0.1508820702548918), '14': ('379', 0.34793152249667597), '15': ('233', 0.16535381893624537), '16': ('131', 0.3183834196632406), '17': ('400', 0.23145277403473805), '18': ('400', 0.11621862703301183), '19': ('599', 0.1353530798290801), '20': ('169', 0.1364682454787991), '21': ('551', 0.16938905355613837), '22': ('139', 0.15221302212152982), '23': ('16', 0.13450875505431897), '24': ('461', 0.13219768322026368), '25': ('30', 0.3849162955582277), '26': ('81', 0.3836549710627175), '27': ('311', 0.1284022825805339), '28': ('599', 0.15349674797309537), '29': ('339', 0.12575315106810148), '30': ('25', 0.3849162955582278), '31': ('276', 0.246841526147031), '32': ('171', 0.18148499403273485), '33': ('251', 0.09901321855381576), '34': ('416', 0.13494670656824834), '35': ('429', 0.335201640597208), '36': ('266', 0.09623895491262484), '37': ('574', 0.37525108705872157), '38': ('588', 0.2712437081456632), '39': ('406', 0.13776851903933052), '40': ('446', 0.1577432758273065), '41': ('233', 0.1492774154573816), '42': ('244', 0.1079749711175328), '43': ('240', 0.2887273090321118), '44': ('214', 0.16625831585277517), '45': ('452', 0.19049049399725768), '46': ('584', 0.31201199696997634), '47': ('131', 0.1641383923247401), '48': ('475', 0.15616899341706025), '49': ('319', 0.18750674999676156), '50': ('153', 0.1635508030809117), '51': ('527', 0.08646566956242348), '52': ('80', 0.1646401053169188), '53': ('278', 0.10617171826000957), '54': ('133', 0.44770077571141365), '55': ('406', 0.1881841150672667), '56': ('574', 0.4435231790021442), '57': ('297', 0.1313195681320631), '58': ('498', 0.23364995900915975), '59': ('465', 0.2424086093482419), '60': ('189', 0.21130003577945106), '61': ('289', 0.2534104135324043), '62': ('362', 0.21036871253082634), '63': ('542', 0.14036177995626245), '64': ('122', 0.1340341509847002), '65': ('123', 0.14646701603071025), '66': ('417', 0.15303172396245862), '67': ('426', 0.2528766906907375), '68': ('217', 0.11640766941011943), '69': ('400', 0.2275131179013857), '70': ('290', 0.11696804299001397), '71': ('350', 0.3512355553277058), '72': ('400', 0.2660980172671528), '73': ('62', 0.12479199475925638), '74': ('290', 0.15701406371090637), '75': ('296', 0.19206079569991727), '76': ('237', 0.17736607599786333), '77': ('503', 0.22223223434867753), '78': ('607', 0.09924114382036485), '79': ('532', 0.1379290713212081), '80': ('239', 0.17062165259660558), '81': ('26', 0.3836549710627175), '82': ('327', 0.16587790508768321), '83': ('551', 0.1572034478241891), '84': ('162', 0.17945703615251068), '85': ('129', 0.20046173783343416), '86': ('407', 0.10446608815045319), '87': ('398', 0.20820991061327693), '88': ('460', 0.22677110854852384), '89': ('76', 0.10870959232992347), '90': ('206', 0.18617744007154302), '91': ('112', 0.12151578637625401), '92': ('521', 0.09182315847025246), '93': ('176', 0.2190326275204007), '94': ('38', 0.2585292076852541), '95': ('371', 0.14894383268739292), '96': ('229', 0.12177086462452008), '97': ('452', 0.1380654132042216), '98': ('291', 0.1695236858339299), '99': ('429', 0.32967351399385075), '100': ('58', 0.11172862835623198), '101': ('535', 0.15013886409561436), '102': ('530', 0.14993027875936774), '103': ('122', 0.13328283677465652), '104': ('426', 0.2054506242161219), '105': ('62', 0.1526018164881655), '106': ('291', 0.2621781471431009), '107': ('192', 0.3677850003042927), '108': ('67', 0.11076070643010782), '109': ('121', 0.27281972447301567), '110': ('409', 0.10007766039421039), '111': ('416', 0.11817589911491021), '112': ('94', 0.24281923673858244), '113': ('118', 0.1031479820546149), '114': ('598', 0.245457581536701), '115': ('304', 0.1369409444489883), '116': ('16', 0.16357956288926057), '117': ('470', 0.2044561534484463), '118': ('214', 0.21024062542937746), '119': ('62', 0.14467330772506323), '120': ('214', 0.27168896729662323), '121': ('404', 0.31982207855287387), '122': ('610', 0.2216360529396414), '123': ('67', 0.16361263562746456), '124': ('400', 0.13830951948344677), '125': ('495', 0.07702140153155304), '126': ('173', 0.3858422490301347), '127': ('472', 0.21012812086036758), '128': ('72', 0.14801211113256638), '129': ('85', 0.20046173783343416), '130': ('374', 0.3463347060021487), '131': ('363', 0.3855472869520665), '132': ('370', 0.16126853664150118), '133': ('386', 0.46528811219700394), '134': ('530', 0.25217777754560494), '135': ('439', 0.13110317001525335), '136': ('126', 0.2617746125078414), '137': ('549', 0.11167884500140207), '138': ('163', 0.1283950975722463), '139': ('298', 0.173519126841742), '140': ('557', 0.10047673805714974), '141': ('83', 0.13461264161263714), '142': ('574', 0.25357447950235096), '143': ('329', 0.09989462711015781), '144': ('359', 0.15756332755043617), '145': ('5', 0.3410305796221039), '146': ('494', 0.12641469156586083), '147': ('449', 0.10134738836497077), '148': ('497', 0.2857211223030927), '149': ('363', 0.13499196040904193), '150': ('277', 0.3322637699792209), '151': ('492', 0.2586113981492031), '152': ('497', 0.2756894936073623), '153': ('50', 0.1635508030809117), '154': ('550', 0.3255565852231059), '155': ('355', 0.16363089514793946), '156': ('461', 0.12674377904314785), '157': ('342', 0.15201680189717443), '158': ('405', 0.10429355638584847), '159': ('173', 0.1925667772554303), '160': ('368', 0.11179665747287419), '161': ('376', 0.07692923715963101), '162': ('173', 0.20112925367725243), '163': ('138', 0.1283950975722463), '164': ('494', 0.22808054092588886), '165': ('197', 0.17775248433457355), '166': ('239', 0.199011878508181), '167': ('54', 0.10674638401365495), '168': ('221', 0.17973718376250514), '169': ('45', 0.18265394487264905), '170': ('173', 0.35594602079632437), '171': ('302', 0.23293101538612734), '172': ('162', 0.11191939877555146), '173': ('126', 0.3858422490301347), '174': ('530', 0.3304330865376714), '175': ('138', 0.06931876681650065), '176': ('574', 0.2704149286742534), '177': ('67', 0.1157595205787696), '178': ('349', 0.1490602573115336), '179': ('229', 0.3197899791939341), '180': ('141', 0.09125933623567913), '181': ('314', 0.25052608139066124), '182': ('606', 0.11242677710963267), '183': ('164', 0.21412637738295925), '184': ('515', 0.21481836293495982), '185': ('430', 0.10356137115761671), '186': ('452', 0.16330728537734798), '187': ('81', 0.14498548135239206), '188': ('290', 0.10940234954224333), '189': ('60', 0.21130003577945106), '190': ('291', 0.2920961211437069), '191': ('145', 0.22405227712636572), '192': ('485', 0.39843034567641844), '193': ('487', 0.20479917639159512), '194': ('262', 0.15464514372247612), '195': ('142', 0.08936569555233694), '196': ('211', 0.16429387199830978), '197': ('165', 0.17775248433457355), '198': ('21', 0.09661473333693833), '199': ('268', 0.10932786665567847), '200': ('169', 0.124139289419407), '201': ('93', 0.17444582971198327), '202': ('469', 0.11662507523279805), '203': ('460', 0.17866210942130242), '204': ('400', 0.1449879342476756), '205': ('245', 0.11551177315049918), '206': ('302', 0.4428843346645422), '207': ('271', 0.12404033890852979), '208': ('81', 0.20927702011656665), '209': ('378', 0.32424936217651484), '210': ('173', 0.2546095566020112), '211': ('30', 0.17522448760478573), '212': ('131', 0.22020195139344448), '213': ('523', 0.09049344337382724), '214': ('120', 0.27168896729662323), '215': ('467', 0.11037876222254604), '216': ('313', 0.08363850914694242), '217': ('329', 0.12438286341026138), '218': ('502', 0.14719407492483624), '219': ('434', 0.10721037725950856), '220': ('475', 0.2329954843667966), '221': ('168', 0.1797371837625051), '222': ('462', 0.12068391240282407), '223': ('81', 0.1799864935948475), '224': ('549', 0.13245625413856246), '225': ('498', 0.16026933668622323), '226': ('56', 0.12358793565049897), '227': ('52', 0.1555358628106774), '228': ('281', 0.16564641047190282), '229': ('179', 0.3197899791939341), '230': ('54', 0.17362831549376467), '231': ('549', 0.3159088098955012), '232': ('540', 0.123629015044696), '233': ('15', 0.16535381893624537), '234': ('584', 0.12695231688233605), '235': ('468', 0.2167952242218377), '236': ('412', 0.09811174499579683), '237': ('569', 0.20295338391606124), '238': ('293', 0.14211425639505845), '239': ('166', 0.19901187850818114), '240': ('43', 0.2887273090321119), '241': ('526', 0.16236675083064095), '242': ('512', 0.37944730104940266), '243': ('486', 0.2870561869927893), '244': ('536', 0.12143105003136016), '245': ('197', 0.15825562278859737), '246': ('106', 0.16381199955303452), '247': ('366', 0.1420431593739333), '248': ('466', 0.18888711531247757), '249': ('573', 0.2058795617176722), '250': ('335', 0.2081967018726062), '251': ('400', 0.3616376306551682), '252': ('601', 0.11363105125727957), '253': ('300', 0.11266029185713747), '254': ('423', 0.18910948022346438), '255': ('281', 0.16908088608806618), '256': ('119', 0.12758380949245662), '257': ('539', 0.13083286392949614), '258': ('601', 0.18614536500784684), '259': ('272', 0.1931062477202513), '260': ('454', 0.09314654604701283), '261': ('400', 0.11946820226754083), '262': ('54', 0.23255266411175718), '263': ('383', 0.15861159381913767), '264': ('54', 0.16862093290935254), '265': ('399', 0.17890826741563623), '266': ('94', 0.13049623422941894), '267': ('201', 0.14670533620684195), '268': ('199', 0.10932786665567847), '269': ('521', 0.2568379767113944), '270': ('206', 0.18663063428583437), '271': ('399', 0.15228407924747672), '272': ('291', 0.25606259720844793), '273': ('229', 0.21138085780361518), '274': ('56', 0.08360957088464654), '275': ('597', 0.11629558627716033), '276': ('240', 0.27070539002297894), '277': ('150', 0.3322637699792209), '278': ('72', 0.19243636945345152), '279': ('141', 0.11618260086949016), '280': ('12', 0.14437738304254058), '281': ('255', 0.16908088608806618), '282': ('601', 0.13919155779945697), '283': ('94', 0.1539452415628901), '284': ('240', 0.2829746630403192), '285': ('59', 0.11822797599956325), '286': ('416', 0.140058627540523), '287': ('428', 0.131000946159249), '288': ('368', 0.11958604087806012), '289': ('61', 0.2534104135324043), '290': ('168', 0.1727663919916063), '291': ('190', 0.2920961211437069), '292': ('422', 0.14888946951388798), '293': ('238', 0.14211425639505845), '294': ('19', 0.12400607077142328), '295': ('417', 0.1390583245104486), '296': ('434', 0.2973735957130632), '297': ('57', 0.1313195681320631), '298': ('599', 0.17501747736601186), '299': ('375', 0.15494304993972308), '300': ('190', 0.19557032726413318), '301': ('609', 0.17982412746702445), '302': ('206', 0.4428843346645422), '303': ('164', 0.18937448303193968), '304': ('93', 0.20253580507160593), '305': ('444', 0.11788555705237859), '306': ('416', 0.09593338113261991), '307': ('428', 0.1661166219063269), '308': ('386', 0.2341930006798792), '309': ('137', 0.08220922995180494), '310': ('61', 0.2014122129221881), '311': ('116', 0.14967481497050636), '312': ('59', 0.1481719667999593), '313': ('55', 0.08563745624582685), '314': ('54', 0.3304341119714124), '315': ('217', 0.10767544836874499), '316': ('449', 0.20431351570435727), '317': ('251', 0.15857025817052436), '318': ('363', 0.11853134985412282), '319': ('49', 0.1875067499967616), '320': ('479', 0.11348503306125006), '321': ('374', 0.2577802724391561), '322': ('165', 0.16116900376140153), '323': ('54', 0.169005607900451), '324': ('207', 0.10195138738428969), '325': ('187', 0.11289638566558031), '326': ('203', 0.11629513414612061), '327': ('82', 0.16587790508768321), '328': ('131', 0.13623794572037398), '329': ('370', 0.2795842950090732), '330': ('109', 0.17827481831130357), '331': ('88', 0.10566595092259833), '332': ('516', 0.1135303167449936), '333': ('442', 0.11763864079364912), '334': ('517', 0.15291713382977076), '335': ('340', 0.20997252391007748), '336': ('72', 0.18414552004255247), '337': ('389', 0.3157174576280746), '338': ('248', 0.14142053851121936), '339': ('103', 0.12872574338142778), '340': ('569', 0.4075963234002594), '341': ('229', 0.12493668959642694), '342': ('157', 0.1520168018971744), '343': ('165', 0.15745728886361418), '344': ('472', 0.16136634133525674), '345': ('206', 0.07480955549159145), '346': ('454', 0.10716228284394523), '347': ('507', 0.3706665886521168), '348': ('400', 0.24090608153566112), '349': ('485', 0.2989044566538409), '350': ('71', 0.3512355553277058), '351': ('276', 0.09537206016824197), '352': ('511', 0.16851914757784361), '353': ('37', 0.23439311753062275), '354': ('557', 0.13671616596982739), '355': ('155', 0.16363089514793946), '356': ('67', 0.09193513045196999), '357': ('554', 0.16970123388558478), '358': ('12', 0.10603198586261456), '359': ('144', 0.1575633275504362), '360': ('452', 0.14623095592700247), '361': ('549', 0.24064827178698067), '362': ('62', 0.21036871253082648), '363': ('131', 0.3855472869520665), '364': ('389', 0.5341673259237008), '365': ('598', 0.16752239857022938), '366': ('247', 0.1420431593739333), '367': ('554', 0.12675842195391565), '368': ('428', 0.12876566787692298), '369': ('399', 0.12281508805064972), '370': ('329', 0.2795842950090732), '371': ('362', 0.19321242181654485), '372': ('242', 0.11939169237157249), '373': ('444', 0.15991343215381912), '374': ('130', 0.3463347060021487), '375': ('439', 0.20272992699322864), '376': ('80', 0.15801884782526635), '377': ('51', 0.07257357093539067), '378': ('209', 0.3242493621765148), '379': ('404', 0.36276553273932544), '380': ('573', 0.16486499234214932), '381': ('541', 0.10367687094781051), '382': ('25', 0.17085402304419803), '383': ('263', 0.15861159381913764), '384': ('591', 0.1622986053577714), '385': ('133', 0.13669465341304377), '386': ('133', 0.4652881121970041), '387': ('599', 0.1395359953778473), '388': ('60', 0.1889533738278745), '389': ('364', 0.5341673259237008), '390': ('293', 0.14038783926690115), '391': ('469', 0.12492978640393176), '392': ('71', 0.09892258348013322), '393': ('30', 0.1614690604328481), '394': ('130', 0.34611851078257383), '395': ('130', 0.18634674387767272), '396': ('423', 0.1328487799157503), '397': ('74', 0.08222776218990174), '398': ('87', 0.20820991061327696), '399': ('265', 0.1789082674156362), '400': ('251', 0.3616376306551682), '401': ('67', 0.19171375207618652), '402': ('179', 0.31468488073549505), '403': ('421', 0.2520993874592112), '404': ('379', 0.3627655327393254), '405': ('134', 0.1508867158536215), '406': ('55', 0.1881841150672667), '407': ('209', 0.20239152913093808), '408': ('460', 0.1284518717567827), '409': ('168', 0.10252100564627283), '410': ('173', 0.15035079257563544), '411': ('436', 0.13916803483653248), '412': ('120', 0.16613084388334448), '413': ('193', 0.16195177887889411), '414': ('122', 0.13729638989321205), '415': ('400', 0.1984882559165543), '416': ('363', 0.2617831612508023), '417': ('400', 0.2061331091046137), '418': ('561', 0.10632560308315958), '419': ('293', 0.12668688698146843), '420': ('77', 0.1001310681216928), '421': ('403', 0.2520993874592112), '422': ('292', 0.14888946951388796), '423': ('254', 0.18910948022346438), '424': ('308', 0.13499413674489283), '425': ('370', 0.16523550618308472), '426': ('67', 0.2528766906907375), '427': ('150', 0.10995723021169972), '428': ('416', 0.19871907222724614), '429': ('584', 0.39810699243824976), '430': ('336', 0.12960401632552687), '431': ('488', 0.14293292326732684), '432': ('379', 0.14685031852774866), '433': ('441', 0.20064660377931157), '434': ('296', 0.29737359571306315), '435': ('515', 0.1608130560434848), '436': ('145', 0.2733513518321751), '437': ('565', 0.17224164297305164), '438': ('475', 0.09003775700966121), '439': ('511', 0.295046600790377), '440': ('385', 0.13004006084979888), '441': ('231', 0.2864778240006447), '442': ('333', 0.11763864079364912), '443': ('148', 0.18055949249109562), '444': ('142', 0.2512960665504515), '445': ('237', 0.13742139044287666), '446': ('81', 0.3577401330887745), '447': ('486', 0.19626598717424862), '448': ('567', 0.09820751885789648), '449': ('316', 0.20431351570435727), '450': ('494', 0.14893865042830426), '451': ('206', 0.2780380890107733), '452': ('45', 0.19049049399725768), '453': ('327', 0.13380100770590783), '454': ('322', 0.12941358355062735), '455': ('54', 0.2629119991978992), '456': ('389', 0.31295757088252985), '457': ('494', 0.14858513598902803), '458': ('498', 0.30716392228639244), '459': ('601', 0.297849259413815), '460': ('601', 0.24816482302664813), '461': ('363', 0.27732540244650894), '462': ('131', 0.1385873852210924), '463': ('48', 0.14232477504068883), '464': ('494', 0.23477125716448255), '465': ('59', 0.24240860934824202), '466': ('363', 0.28612014983420586), '467': ('598', 0.25437356109345804), '468': ('126', 0.23985134103854014), '469': ('391', 0.1249297864039318), '470': ('455', 0.22093991129832588), '471': ('416', 0.21864604919012498), '472': ('598', 0.25109085277955207), '473': ('545', 0.1261237829237454), '474': ('265', 0.09379529548397542), '475': ('220', 0.23299548436679668), '476': ('530', 0.29839845448797947), '477': ('122', 0.12750112888144932), '478': ('5', 0.15352328608892993), '479': ('149', 0.1150527664882892), '480': ('431', 0.09143171305203378), '481': ('297', 0.12336147630242889), '482': ('475', 0.11979275047103458), '483': ('601', 0.11196882347718137), '484': ('327', 0.10988126499913894), '485': ('192', 0.39843034567641844), '486': ('340', 0.3726723027464544), '487': ('193', 0.20479917639159514), '488': ('431', 0.14293292326732684), '489': ('428', 0.13443386972706853), '490': ('449', 0.16990645675038793), '491': ('291', 0.2263033543625135), '492': ('337', 0.28174910436868084), '493': ('72', 0.09245465529924421), '494': ('464', 0.23477125716448252), '495': ('122', 0.17743276336026328), '496': ('3', 0.1790076798135405), '497': ('363', 0.3085136198596273), '498': ('458', 0.30716392228639244), '499': ('411', 0.1120805141663288), '500': ('94', 0.13629499675908555), '501': ('179', 0.2084642652020315), '502': ('218', 0.14719407492483624), '503': ('77', 0.22223223434867753), '504': ('250', 0.08009957259368716), '505': ('251', 0.11499080734506548), '506': ('564', 0.09023853479899593), '507': ('347', 0.3706665886521168), '508': ('545', 0.10443194926536012), '509': ('50', 0.11194332824729528), '510': ('428', 0.10058089393907362), '511': ('25', 0.3344521829754379), '512': ('242', 0.37944730104940266), '513': ('61', 0.24383032926166842), '514': ('67', 0.15642378926383207), '515': ('25', 0.36967271525154416), '516': ('367', 0.1155769357823849), '517': ('334', 0.15291713382977076), '518': ('424', 0.12544900668815392), '519': ('413', 0.1403292542282758), '520': ('296', 0.15904598320413493), '521': ('269', 0.2568379767113944), '522': ('490', 0.10131870696339328), '523': ('601', 0.21581811328206021), '524': ('485', 0.17827881379504246), '525': ('509', 0.10827406436933855), '526': ('241', 0.16236675083064098), '527': ('441', 0.15035122711697965), '528': ('114', 0.17591970244879435), '529': ('277', 0.18789462279433264), '530': ('174', 0.3304330865376713), '531': ('209', 0.1405367403944984), '532': ('494', 0.21169471031062895), '533': ('601', 0.10838732751646792), '534': ('475', 0.1834200476339332), '535': ('101', 0.15013886409561433), '536': ('94', 0.22899838663764804), '537': ('549', 0.2223451946184137), '538': ('87', 0.14617265751791642), '539': ('459', 0.13322554933700698), '540': ('166', 0.1750792497048532), '541': ('379', 0.2934726330457362), '542': ('63', 0.14036177995626245), '543': ('601', 0.1308462344574355), '544': ('389', 0.22440486645631288), '545': ('587', 0.16902510206046023), '546': ('75', 0.10978074745671317), '547': ('116', 0.13068125056649196), '548': ('196', 0.12406488414501811), '549': ('231', 0.3159088098955012), '550': ('30', 0.374616412245278), '551': ('67', 0.21263238809108906), '552': ('599', 0.08557689360812305), '553': ('585', 0.24090248823064514), '554': ('357', 0.16970123388558475), '555': ('201', 0.1297520585443903), '556': ('581', 0.15713399703259143), '557': ('549', 0.23522961398698763), '558': ('410', 0.10422277736071711), '559': ('507', 0.21333502853126668), '560': ('24', 0.09155340020780588), '561': ('139', 0.1357201129715669), '562': ('251', 0.10090856769829464), '563': ('207', 0.08589379049428868), '564': ('2', 0.10352588991738486), '565': ('242', 0.33513770465162873), '566': ('446', 0.20933160009436927), '567': ('139', 0.1586324534208264), '568': ('444', 0.16597849746838306), '569': ('340', 0.4075963234002594), '570': ('81', 0.1655027585321494), '571': ('607', 0.0776399035708335), '572': ('290', 0.13306433771787315), '573': ('249', 0.20587956171767227), '574': ('56', 0.44352317900214416), '575': ('251', 0.07541437489636177), '576': ('496', 0.13213396516087292), '577': ('27', 0.12109488509741395), '578': ('306', 0.09117298644399358), '579': ('235', 0.14282032461300462), '580': ('239', 0.12393723965448702), '581': ('190', 0.27142506388911697), '582': ('291', 0.2452928992713805), '583': ('467', 0.15729026595895654), '584': ('429', 0.3981069924382497), '585': ('553', 0.24090248823064517), '586': ('475', 0.1819491811545314), '587': ('545', 0.16902510206046023), '588': ('394', 0.32144120245677305), '589': ('530', 0.2548993845515908), '590': ('561', 0.12885529566176374), '591': ('384', 0.1622986053577714), '592': ('340', 0.2629251591645869), '593': ('428', 0.1564265849195572), '594': ('402', 0.1827658205839214), '595': ('336', 0.12261560689510725), '596': ('308', 0.10100263345831174), '597': ('1', 0.14173381404256077), '598': ('467', 0.25437356109345804), '599': ('298', 0.17501747736601175), '600': ('609', 0.12541909947924093), '601': ('30', 0.3047758657275638), '602': ('512', 0.2271486614258256), '603': ('325', 0.09601066436807289), '604': ('134', 0.1497607356412837), '605': ('395', 0.1689210807495617), '606': ('182', 0.11242677710963264), '607': ('183', 0.15145899950865035), '608': ('307', 0.1371869851790466), '609': ('54', 0.4429365340642146), '610': ('122', 0.22163605293964145)}
    return fileData, data,similar_list



